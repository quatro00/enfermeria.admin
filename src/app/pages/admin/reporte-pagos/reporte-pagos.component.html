<!-- Lotes de Pagos usando Angular Material -->
<div class="p-6">
  <mat-card class="mb-6">
    <mat-card-title>Lotes de Pago</mat-card-title>
    <div class="overflow-auto">
      <table mat-table [dataSource]="lotes" class="mat-elevation-z8 w-full">

        <!-- ID Lote -->
        <ng-container matColumnDef="idLote">
          <th mat-header-cell *matHeaderCellDef> ID Lote </th>
          <td mat-cell *matCellDef="let lote"> {{lote.idLote}} </td>
        </ng-container>

        <!-- Fecha -->
        <ng-container matColumnDef="fecha">
          <th mat-header-cell *matHeaderCellDef> Fecha de creación </th>
          <td mat-cell *matCellDef="let lote"> {{lote.fecha}} </td>
        </ng-container>

        <!-- Total -->
        <ng-container matColumnDef="total">
          <th mat-header-cell *matHeaderCellDef> Total del Lote </th>
          <td mat-cell *matCellDef="let lote"> {{lote.total | currency}} </td>
        </ng-container>

        <!-- Numero de Pagos -->
        <ng-container matColumnDef="numPagos">
          <th mat-header-cell *matHeaderCellDef> Número de Pagos </th>
          <td mat-cell *matCellDef="let lote"> {{lote.numPagos}} </td>
        </ng-container>

        <!-- Estatus -->
        <ng-container matColumnDef="estatus">
          <th mat-header-cell *matHeaderCellDef> Estatus </th>
          <td mat-cell *matCellDef="let lote">
            <span [ngClass]="{
              'bg-green-100 text-green-800 px-2 py-1 rounded': lote.estatus === 'Procesado',
              'bg-yellow-100 text-yellow-800 px-2 py-1 rounded': lote.estatus === 'En Revisión',
              'bg-red-100 text-red-800 px-2 py-1 rounded': lote.estatus === 'Cancelado'
            }">
              {{lote.estatus}}
            </span>
          </td>
        </ng-container>

        <!-- Acciones -->
        <ng-container matColumnDef="acciones">
          <th mat-header-cell *matHeaderCellDef> Acciones </th>
          <td mat-cell *matCellDef="let lote">
            <button mat-button color="primary">Ver Detalles</button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

        <!-- Totales -->
        <tr mat-footer-row *matFooterRowDef="displayedColumns"></tr>
      </table>
      <div class="text-right p-4 font-bold">
        Total General: 0
      </div>
    </div>
  </mat-card>

  <!-- Pagos en el Lote -->
  <mat-card>
    <mat-card-title>Pagos en el Lote Seleccionado</mat-card-title>
    <div class="overflow-auto">
      <table mat-table [dataSource]="pagos" class="mat-elevation-z8 w-full">

        <!-- Columnas -->
        <ng-container matColumnDef="idPago">
          <th mat-header-cell *matHeaderCellDef> ID Pago </th>
          <td mat-cell *matCellDef="let pago"> {{pago.idPago}} </td>
        </ng-container>

        <ng-container matColumnDef="folio">
          <th mat-header-cell *matHeaderCellDef> Folio / Referencia </th>
          <td mat-cell *matCellDef="let pago"> {{pago.folio}} </td>
        </ng-container>

        <ng-container matColumnDef="beneficiario">
          <th mat-header-cell *matHeaderCellDef> Beneficiario </th>
          <td mat-cell *matCellDef="let pago"> {{pago.beneficiario}} </td>
        </ng-container>

        <ng-container matColumnDef="monto">
          <th mat-header-cell *matHeaderCellDef> Monto </th>
          <td mat-cell *matCellDef="let pago"> {{pago.monto | currency}} </td>
        </ng-container>

        <ng-container matColumnDef="fechaPago">
          <th mat-header-cell *matHeaderCellDef> Fecha del Pago </th>
          <td mat-cell *matCellDef="let pago"> {{pago.fechaPago}} </td>
        </ng-container>

        <ng-container matColumnDef="estatusPago">
          <th mat-header-cell *matHeaderCellDef> Estatus del Pago </th>
          <td mat-cell *matCellDef="let pago">
            <span [ngClass]="{
              'bg-green-100 text-green-800 px-2 py-1 rounded': pago.estatusPago === 'Pagado',
              'bg-yellow-100 text-yellow-800 px-2 py-1 rounded': pago.estatusPago === 'Pendiente',
              'bg-red-100 text-red-800 px-2 py-1 rounded': pago.estatusPago === 'Fallido'
            }">
              {{pago.estatusPago}}
            </span>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedPagos"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedPagos;"></tr>
      </table>
      <div class="text-right p-4 font-bold">
        Total de Pagos: {{ pagos.reduce((acc, item) => acc + item.monto, 0) | currency }}
      </div>
    </div>
  </mat-card>
</div>

<!-- Dummy Data en el componente -->
<script>
  export class PagosComponent {
    displayedColumns = ['idLote', 'fecha', 'total', 'numPagos', 'estatus', 'acciones'];
    displayedPagos = ['idPago', 'folio', 'beneficiario', 'monto', 'fechaPago', 'estatusPago'];

    lotes = [
      { idLote: 1, fecha: '2024-04-01', total: 5400, numPagos: 3, estatus: 'Procesado' },
      { idLote: 2, fecha: '2024-04-05', total: 7250, numPagos: 4, estatus: 'En Revisión' },
      { idLote: 3, fecha: '2024-04-09', total: 3100, numPagos: 1, estatus: 'Cancelado' },
      { idLote: 4, fecha: '2024-04-15', total: 4800, numPagos: 2, estatus: 'Procesado' }
    ];

    pagos = [
      { idPago: 101, folio: 'A12345', beneficiario: 'Juan Perez', monto: 1500, fechaPago: '2024-04-01', estatusPago: 'Pagado' },
      { idPago: 102, folio: 'B67890', beneficiario: 'María Gómez', monto: 2300, fechaPago: '2024-04-02', estatusPago: 'Pagado' },
      { idPago: 103, folio: 'C45678', beneficiario: 'Carlos Ruiz', monto: 1200, fechaPago: '2024-04-03', estatusPago: 'Pendiente' },
      { idPago: 104, folio: 'D98755', beneficiario: 'Ana López', monto: 400, fechaPago: '2024-04-04', estatusPago: 'Fallido' }
    ];
  }
</script>
